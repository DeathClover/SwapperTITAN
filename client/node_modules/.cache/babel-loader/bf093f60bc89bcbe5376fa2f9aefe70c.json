{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Chris Lytrokapis\\\\Desktop\\\\Dev\\\\Projects\\\\Swapper\\\\client\\\\src\\\\App.js\";\nimport React, { Component } from 'react';\nimport Web3 from 'web3';\nimport TokenX from '../abis/TokenX.json';\nimport Swap from '../abis/EthSwap.json';\nimport Navbar from './Navbar';\nimport Main from './Main';\nimport LoadWallet from './LoadWallet';\nimport './App.css';\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.buyTokens = async etherAmount => {\n      this.setState({\n        loading: true\n      });\n      await this.state.ethSwap.methods.buyTokens().send({\n        value: etherAmount,\n        from: this.state.account\n      }).on('transactionHash', hash => {\n        this.setState({\n          txState: 'onTxHash'\n        });\n      }).on('confirmation', async (confirmationNumber, receipt) => {\n        this.setState({\n          txState: 'onConfirmation'\n        });\n        const web3 = window.web3;\n        const ethBalance = await web3.eth.getBalance(this.state.account);\n        let tokenBalance = await this.state.token.methods.balanceOf(this.state.account).call();\n        this.setState({\n          ethBalance: ethBalance,\n          tokenBalance: tokenBalance.toString()\n        });\n        console.log(\"BuyTokens.on.Confirmation: ConfirmationNumber: \" + confirmationNumber + \" -> Receip.events: \" + JSON.stringify(receipt));\n      });\n      this.setState({\n        txState: '',\n        loading: false\n      });\n    };\n\n    this.sellTokens = async tokenAmount => {\n      console.log(\"this.state.ethSwap.address: \" + this.state.ethSwap.address);\n      this.setState({\n        loading: true\n      });\n      await this.state.token.methods.approve(this.state.ethSwap.options.address, tokenAmount).send({\n        from: this.state.account\n      }).on('transactionHash', async hash => {\n        this.setState({\n          txState: 'onTxHash'\n        });\n        await this.state.ethSwap.methods.sellTokens(tokenAmount).send({\n          from: this.state.account\n        }).on('transactionHash', hash => {\n          this.setState({\n            txState: 'onTxHash'\n          });\n        }).on('confirmation', async (confirmationNumber, receipt) => {\n          this.setState({\n            txState: 'onConfirmation'\n          });\n          const web3 = window.web3;\n          const ethBalance = await web3.eth.getBalance(this.state.account);\n          let tokenBalance = await this.state.token.methods.balanceOf(this.state.account).call();\n          this.setState({\n            ethBalance: ethBalance,\n            tokenBalance: tokenBalance.toString()\n          });\n          console.log(\"SellTokens.on.Confirmation: ConfirmationNumber: \" + confirmationNumber + \" -> Receip.events: \" + JSON.stringify(receipt));\n        });\n        this.setState({\n          loading: false,\n          txState: ''\n        });\n      });\n    };\n\n    this.handleClick = this.handleClick.bind(this);\n    this.state = {\n      account: '',\n      //contract deployer account[0]\n      token: {},\n      //Deployed instance of ARG contract in KOVAN\n      ethSwap: {},\n      //Deployed instance of ethSwap contract in KOVAN\n      ethBalance: '0',\n      tokenBalance: '0',\n      loading: true,\n      walletLoaded: false,\n      txState: '',\n      web3Socket: {},\n      ethSwapWebSocket: {},\n      lastReceivedEvent: {\n        'Event': 'no event'\n      }\n    };\n  }\n\n  async loadWallet() {\n    this.setState({\n      loading: true\n    });\n    await this.loadWeb3();\n    await this.loadBlockchainData();\n    await this.loadEthSwapWebSocket(); //subscribe to event TokenPurchased \n\n    await this.state.ethSwapWebSocket.events.TokensPurchased({}).on('data', async event => {\n      let amount = event.returnValues._value.toString();\n\n      window.alert('ARG Token purchased: ' + window.web3.utils.fromWei(amount, 'Ether'));\n      console.log('ARG TokenPurchase tx confirmed \\n');\n      console.log('From account: ', event.returnValues._from.toString());\n      console.log('Amount in ARG: ', window.web3.utils.fromWei(amount, 'Ether'));\n      this.setState({\n        lastReceivedEvent: event.returnValues\n      });\n      console.log(event.returnValues);\n    }).on('error', error => {\n      this.setState({\n        lastReceivedEvent: error\n      });\n      console.log(error);\n    }); //subscribe to event TokenSold\n\n    await this.state.ethSwapWebSocket.events.TokensSold({}).on('data', async event => {\n      let amount = event.returnValues._value.toString();\n\n      window.alert('ARG Token Sold: ' + window.web3.utils.fromWei(amount, 'Ether'));\n      console.log('ARG TokenPurchase tx confirmed \\n');\n      console.log('From account: ', event.returnValues._from.toString());\n      console.log('Amount in ARG: ', window.web3.utils.fromWei(amount, 'Ether'));\n      this.setState({\n        lastReceivedEvent: event.returnValues\n      });\n      console.log(event.returnValues);\n    }).on('error', error => {\n      this.setState({\n        lastReceivedEvent: error\n      });\n      console.log(error);\n    });\n    this.setState({\n      loading: false\n    });\n  } //Load EthSwap instance via infura webSocket API\n\n\n  async loadEthSwapWebSocket() {\n    const URL = \"wss://kovan.infura.io/ws/v3/\".concat(process.env.REACT_APP_INFURA_APIKEY);\n    let web3Socket = new Web3(new Web3.providers.WebsocketProvider(URL));\n\n    if (web3Socket) {\n      const web3 = window.web3;\n      const networkId = await web3.eth.net.getId();\n      const ethSwapWebSocketData = EthSwap.networks[networkId];\n\n      if (ethSwapWebSocketData) {\n        const ethSwapWebSocket = await new web3Socket.eth.Contract(EthSwap.abi, ethSwapWebSocketData.address);\n        this.setState({\n          ethSwapWebSocket\n        });\n      } else {\n        window.alert('EthSwap contract not deployed to detected network.');\n      }\n    } else {\n      window.alert('Could not establish web socket connection to infura');\n    }\n  } //Load EthSwap and ARG token instances via Metamask web3\n\n\n  async loadBlockchainData() {\n    const web3 = window.web3;\n    const accounts = await web3.eth.getAccounts();\n    this.setState({\n      account: accounts[0]\n    });\n    const ethBalance = await web3.eth.getBalance(this.state.account);\n    this.setState({\n      ethBalance\n    }); // Load ARG Token\n\n    const networkId = await web3.eth.net.getId();\n    const tokenData = Token.networks[networkId];\n\n    if (tokenData) {\n      const token = new web3.eth.Contract(Token.abi, tokenData.address);\n      this.setState({\n        token\n      });\n      let tokenBalance = await token.methods.balanceOf(this.state.account).call();\n      this.setState({\n        tokenBalance: tokenBalance.toString()\n      });\n      console.log(\"ARG Token address: \", tokenData.address);\n    } else {\n      window.alert('Token contract not deployed to detected network.');\n    } // Load EthSwap\n\n\n    const ethSwapData = await EthSwap.networks[networkId];\n\n    if (ethSwapData) {\n      const ethSwap = new web3.eth.Contract(EthSwap.abi, ethSwapData.address);\n      this.setState({\n        ethSwap\n      });\n      console.log('ethSwap.options.address:' + this.state.ethSwap.options.address);\n    } else {\n      window.alert('EthSwap contract not deployed to detected network.');\n    }\n  }\n\n  async loadWeb3() {\n    if (window.ethereum) {\n      window.web3 = new Web3(window.ethereum); //window.web3 = new Web3(\"http://localhost:8545\")\n      //window.web3 = new Web3(new Web3.providers.WebsocketProvider('ws://localhost:8545'))\n\n      await window.ethereum.enable();\n      await window.ethereum.on('accountsChanged', async () => {\n        const accounts = await window.web3.eth.getAccounts();\n        this.setState({\n          account: accounts[0]\n        });\n      });\n      this.setState({\n        walletLoaded: true\n      });\n    } else {\n      window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!');\n      this.setState({\n        walletLoaded: false\n      });\n    }\n  }\n\n  async handleClick() {\n    if (!this.state.walletLoaded) {\n      await this.loadWallet();\n    } else {\n      this.setState({\n        walletLoaded: false\n      });\n      ;\n    }\n\n    console.log('TypeOf: ', typeof this.state.lastReceivedEvent);\n  }\n\n  render() {\n    let content;\n\n    if (this.state.walletLoaded) {\n      if (this.state.loading) {\n        let txStatus;\n\n        switch (this.state.txState) {\n          case 'onTxHash':\n            txStatus = 'Transaction Hash received from Kovan network...';\n            break;\n\n          case 'onConfirmation':\n            txStatus = 'Confirmation received from Kovan network...';\n            break;\n\n          case 'onReceipt':\n            txStatus = 'Tx receipt received from Kovan network. See console logs...';\n            break;\n\n          case 'onError':\n            txStatus = 'Tx error received from Kovan network. Tx reverted...';\n            break;\n\n          default:\n            txStatus = '';\n        }\n\n        content = React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 224\n          },\n          __self: this\n        }, React.createElement(\"p\", {\n          id: \"loader\",\n          className: \"text-center\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 225\n          },\n          __self: this\n        }, \"Loading...\"), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 226\n          },\n          __self: this\n        }), React.createElement(\"p\", {\n          className: \"tx\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 227\n          },\n          __self: this\n        }, txStatus));\n      } else {\n        const events = this.state.lastReceivedEvent;\n        content = React.createElement(\"div\", {\n          className: \"row\",\n          style: {\n            display: \"flex\",\n            justifyContent: \"center\",\n            alignItems: \"center\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 232\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"col-md-6\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 238\n          },\n          __self: this\n        }, React.createElement(Main, {\n          ethBalance: this.state.ethBalance,\n          tokenBalance: this.state.tokenBalance,\n          buyTokens: this.buyTokens,\n          sellTokens: this.sellTokens,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 239\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          className: \"col-md-6\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 246\n          },\n          __self: this\n        }, React.createElement(LoadWallet, {\n          handleClick: this.handleClick,\n          walletLoaded: this.state.walletLoaded,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 247\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 248\n          },\n          __self: this\n        }), \"Last event received fom Kovan:\", React.createElement(\"ul\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 250\n          },\n          __self: this\n        }, Object.keys(events).map((event, index) => React.createElement(\"li\", {\n          key: index,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 251\n          },\n          __self: this\n        }, event, \" : \", events[event])))));\n      }\n    } else {\n      content = React.createElement(\"div\", {\n        style: {\n          alignItems: \"center\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260\n        },\n        __self: this\n      }, \"Welcome\"), React.createElement(\"ul\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261\n        },\n        __self: this\n      }, React.createElement(\"li\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 262\n        },\n        __self: this\n      }, React.createElement(\"h5\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 262\n        },\n        __self: this\n      }, \"Click the button below to connect Metamask wallet.\")), React.createElement(\"li\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263\n        },\n        __self: this\n      }, React.createElement(\"h5\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263\n        },\n        __self: this\n      }, \"Don't forget to select \\\"Kovan Test Network\\\" in Metamask App.\")), React.createElement(\"li\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264\n        },\n        __self: this\n      }, React.createElement(\"h5\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264\n        },\n        __self: this\n      }, \"If you don\\xB4t own Ether on Kovan you can request it for free at https://faucet.kovan.network/.\"))), React.createElement(LoadWallet, {\n        handleClick: this.handleClick,\n        walletLoaded: this.state.walletLoaded,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 266\n        },\n        __self: this\n      })));\n    }\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273\n      },\n      __self: this\n    }, React.createElement(Navbar, {\n      account: this.state.account,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"container-fluid mt-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 275\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 276\n      },\n      __self: this\n    }, React.createElement(\"main\", {\n      role: \"main\",\n      className: \"col-lg-12 ml-auto mr-auto\",\n      style: {\n        maxWidth: '1000px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"content mr-auto ml-auto\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      href: \"http://alejoacosta.ar\",\n      target: \"_blank\",\n      rel: \"noopener noreferrer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279\n      },\n      __self: this\n    }), content)))));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["C:/Users/Chris Lytrokapis/Desktop/Dev/Projects/Swapper/client/src/App.js"],"names":["React","Component","Web3","TokenX","Swap","Navbar","Main","LoadWallet","App","constructor","props","buyTokens","etherAmount","setState","loading","state","ethSwap","methods","send","value","from","account","on","hash","txState","confirmationNumber","receipt","web3","window","ethBalance","eth","getBalance","tokenBalance","token","balanceOf","call","toString","console","log","JSON","stringify","sellTokens","tokenAmount","address","approve","options","handleClick","bind","walletLoaded","web3Socket","ethSwapWebSocket","lastReceivedEvent","loadWallet","loadWeb3","loadBlockchainData","loadEthSwapWebSocket","events","TokensPurchased","event","amount","returnValues","_value","alert","utils","fromWei","_from","error","TokensSold","URL","process","env","REACT_APP_INFURA_APIKEY","providers","WebsocketProvider","networkId","net","getId","ethSwapWebSocketData","EthSwap","networks","Contract","abi","accounts","getAccounts","tokenData","Token","ethSwapData","ethereum","enable","render","content","txStatus","display","justifyContent","alignItems","Object","keys","map","index","maxWidth"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport Web3 from 'web3'\nimport TokenX from '../abis/TokenX.json'\nimport Swap from '../abis/EthSwap.json'\nimport Navbar from './Navbar'\nimport Main from './Main'\nimport LoadWallet from './LoadWallet'\nimport './App.css'\n\nclass App extends Component {\n\n  constructor(props) {\n    super(props)    \n    this.handleClick = this.handleClick.bind(this);\n    this.state = {\n      account: '', //contract deployer account[0]\n      token: {}, //Deployed instance of ARG contract in KOVAN\n      ethSwap: {}, //Deployed instance of ethSwap contract in KOVAN\n      ethBalance: '0',\n      tokenBalance: '0',\n      loading: true,\n      walletLoaded: false,\n      txState : '',\n      web3Socket: {},\n      ethSwapWebSocket: {},\n      lastReceivedEvent: { 'Event' : 'no event'}      \n    }\n  }\n\n  async loadWallet() {    \n    this.setState({ loading: true })\n    await this.loadWeb3()\n    await this.loadBlockchainData()    \n    await this.loadEthSwapWebSocket();    \n\n    //subscribe to event TokenPurchased \n    await this.state.ethSwapWebSocket.events.TokensPurchased({})\n    .on('data', async (event) =>{\n        let amount = event.returnValues._value.toString()\n        window.alert('ARG Token purchased: ' + window.web3.utils.fromWei(amount, 'Ether'))\n        console.log('ARG TokenPurchase tx confirmed \\n')\n        console.log('From account: ', event.returnValues._from.toString())        \n        console.log('Amount in ARG: ', window.web3.utils.fromWei(amount, 'Ether') )\n        this.setState({ lastReceivedEvent : event.returnValues})\n        console.log(event.returnValues)    \n    })\n    .on('error', (error) => {\n      this.setState({ lastReceivedEvent : error})\n      console.log(error);\n    })\n    \n    //subscribe to event TokenSold\n    await this.state.ethSwapWebSocket.events.TokensSold({})\n    .on('data', async (event) =>{\n        let amount = event.returnValues._value.toString()\n        window.alert('ARG Token Sold: ' + window.web3.utils.fromWei(amount, 'Ether'))\n        console.log('ARG TokenPurchase tx confirmed \\n')\n        console.log('From account: ', event.returnValues._from.toString())        \n        console.log('Amount in ARG: ', window.web3.utils.fromWei(amount, 'Ether') )\n        this.setState({ lastReceivedEvent : event.returnValues})\n        console.log(event.returnValues)        \n    })\n    .on('error', (error) => {\n      this.setState({ lastReceivedEvent : error});\n      console.log(error);\n    }) \n\n    this.setState({ loading: false });   \n\n  }\n\n  //Load EthSwap instance via infura webSocket API\n  async loadEthSwapWebSocket(){\n    const URL = `wss://kovan.infura.io/ws/v3/${process.env.REACT_APP_INFURA_APIKEY}`\n    let web3Socket = new Web3(new Web3.providers.WebsocketProvider(URL));\n    \n    if (web3Socket){      \n      const web3 = window.web3\n      const networkId =  await web3.eth.net.getId()\n      const ethSwapWebSocketData = EthSwap.networks[networkId]\n      if(ethSwapWebSocketData) {\n        const ethSwapWebSocket = await new web3Socket.eth.Contract(EthSwap.abi, ethSwapWebSocketData.address)\n        this.setState({ ethSwapWebSocket })\n      } else {\n        window.alert('EthSwap contract not deployed to detected network.')\n      }    \n    } else{\n      window.alert('Could not establish web socket connection to infura')\n    }     \n  }\n\n  //Load EthSwap and ARG token instances via Metamask web3\n  async loadBlockchainData() {\n    const web3 = window.web3  \n    const accounts = await web3.eth.getAccounts()\n    this.setState({ account: accounts[0] })\n    const ethBalance = await web3.eth.getBalance(this.state.account)\n    this.setState({ ethBalance })\n\n    // Load ARG Token\n    const networkId =  await web3.eth.net.getId()\n    const tokenData = Token.networks[networkId]\n    if(tokenData) {\n      const token = new web3.eth.Contract(Token.abi, tokenData.address)\n      this.setState({ token })\n      let tokenBalance = await token.methods.balanceOf(this.state.account).call()\n      this.setState({ tokenBalance: tokenBalance.toString() })\n      console.log(\"ARG Token address: \", tokenData.address)\n    } else {\n      window.alert('Token contract not deployed to detected network.')\n    }\n\n    // Load EthSwap\n    const ethSwapData = await EthSwap.networks[networkId]\n    if(ethSwapData) {\n      const ethSwap = new web3.eth.Contract(EthSwap.abi, ethSwapData.address)\n      this.setState({ ethSwap })\n      console.log('ethSwap.options.address:' + this.state.ethSwap.options.address)      \n    } else {\n      window.alert('EthSwap contract not deployed to detected network.')\n    }    \n  }  \n\n  async loadWeb3() {\n    if (window.ethereum) {\n      window.web3 = new Web3(window.ethereum);\n      //window.web3 = new Web3(\"http://localhost:8545\")\n      //window.web3 = new Web3(new Web3.providers.WebsocketProvider('ws://localhost:8545'))\n      await window.ethereum.enable();\n      await window.ethereum.on('accountsChanged', async () => {\n        const accounts = await window.web3.eth.getAccounts();            \n        this.setState({ account: accounts[0] })       \n      })\n      this.setState({walletLoaded : true});      \n    }\n    else {\n      window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!')\n      this.setState({walletLoaded : false});      \n    }\n    \n  } \n\n  buyTokens = async (etherAmount) => {\n    this.setState({ loading: true })\n    await this.state.ethSwap.methods.buyTokens().send({ value: etherAmount, from: this.state.account })\n      .on('transactionHash', (hash) => {\n        this.setState({ txState: 'onTxHash' })\n      })\n      .on('confirmation', async (confirmationNumber, receipt) =>{        \n        this.setState({ txState: 'onConfirmation' })\n        const web3 = window.web3  \n        const ethBalance = await web3.eth.getBalance(this.state.account)        \n        let tokenBalance = await this.state.token.methods.balanceOf(this.state.account).call()\n        this.setState({ \n          ethBalance : ethBalance ,\n          tokenBalance: tokenBalance.toString() ,           \n         })\n        console.log(\"BuyTokens.on.Confirmation: ConfirmationNumber: \" + confirmationNumber + \" -> Receip.events: \" + JSON.stringify(receipt))\n      })\n    this.setState({\n      txState: '',\n      loading: false\n      })    \n  }  \n\n  sellTokens = async (tokenAmount) => {\n    console.log(\"this.state.ethSwap.address: \" + this.state.ethSwap.address)\n    this.setState({ loading: true })\n    await this.state.token.methods.approve(this.state.ethSwap.options.address, tokenAmount).send({ from: this.state.account })\n    .on('transactionHash', async (hash) => {\n        this.setState({ txState: 'onTxHash' })\n        await this.state.ethSwap.methods.sellTokens(tokenAmount).send({ from: this.state.account })        \n        .on('transactionHash', (hash) => {\n          this.setState({ txState: 'onTxHash' })\n          })\n        .on('confirmation', async (confirmationNumber, receipt) =>{      \n          this.setState({ txState: 'onConfirmation' })\n          const web3 = window.web3  \n          const ethBalance = await web3.eth.getBalance(this.state.account)\n          let tokenBalance = await this.state.token.methods.balanceOf(this.state.account).call()\n          this.setState({ \n            ethBalance : ethBalance ,\n            tokenBalance: tokenBalance.toString() ,             \n          })\n          console.log(\"SellTokens.on.Confirmation: ConfirmationNumber: \" + confirmationNumber + \" -> Receip.events: \" + JSON.stringify(receipt))\n        })\n    this.setState({\n      loading: false ,\n      txState: '' })        \n    })\n  }\n\n  async handleClick(){       \n      if (!this.state.walletLoaded) {\n          await this.loadWallet();\n      } else {            \n        this.setState({walletLoaded : false}); ;\n      }      \n      console.log('TypeOf: ', typeof this.state.lastReceivedEvent)\n  }\n\n\n  render() {\n    let content;    \n    if (this.state.walletLoaded){\n      if(this.state.loading) {\n        let txStatus;\n        switch(this.state.txState){\n          case 'onTxHash':\n            txStatus = 'Transaction Hash received from Kovan network...';\n            break;\n          case 'onConfirmation':\n            txStatus = 'Confirmation received from Kovan network...';\n            break;\n          case 'onReceipt':\n            txStatus = 'Tx receipt received from Kovan network. See console logs...';\n            break;\n          case 'onError':\n            txStatus = 'Tx error received from Kovan network. Tx reverted...';\n            break;\n          default :\n            txStatus = '' ;\n        }\n        content = <div>\n          <p id=\"loader\" className=\"text-center\">Loading...</p>\n          <br/>\n          <p className='tx'>{txStatus}</p>\n        </div>\n      }else {\n        const events = this.state.lastReceivedEvent;\n        content = \n        <div className=\"row\" style={{\n              display: \"flex\",\n              justifyContent: \"center\",\n              alignItems: \"center\"\n              }}\n        >\n          <div className=\"col-md-6\">\n            <Main\n              ethBalance={this.state.ethBalance}\n              tokenBalance={this.state.tokenBalance}\n              buyTokens={this.buyTokens}\n              sellTokens={this.sellTokens}\n            />            \n          </div>          \n          <div className=\"col-md-6\" >\n            <LoadWallet handleClick={this.handleClick} walletLoaded={this.state.walletLoaded} />  \n            <br/>\n            Last event received fom Kovan:\n            <ul>\n            {Object.keys(events).map((event, index) => <li key={index}>{event} : {events[event]}</li>)}\n            </ul>           \n          </div>\n        </div>  \n      }\n    }\n    else {\n      content = <div style={{ alignItems: \"center\" }}>\n        <div className=\"container\" >\n        <h3>Welcome</h3>\n         <ul>\n         <li><h5>Click the button below to connect Metamask wallet.</h5></li>\n         <li><h5>Don't forget to select \"Kovan Test Network\" in Metamask App.</h5></li>                      \n         <li><h5>If you don´t own Ether on Kovan you can request it for free at https://faucet.kovan.network/.</h5></li>        \n        </ul>   \n        <LoadWallet handleClick={this.handleClick} walletLoaded={this.state.walletLoaded} />\n        </div>\n      </div>\n\n    }\n\n    return (\n      <div>\n        <Navbar account={this.state.account} />\n        <div className=\"container-fluid mt-5\">\n          <div className=\"row\">\n            <main role=\"main\" className=\"col-lg-12 ml-auto mr-auto\" style={{ maxWidth: '1000px' }}>\n              <div className=\"content mr-auto ml-auto\">\n                <a\n                  href=\"http://alejoacosta.ar\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                </a>\n\n                {content}\n\n              </div>\n            </main>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}